/*
 * ssdCascadingDropDown jQuery plugin
 * Examples and documentation at: https://github.com/sebastiansulinski/cascading-dropdown
 * Copyright (c) 2016 Sebastian Sulinski
 * Version: 1.4.3 (26-JUN-2017)
 * Licensed under the MIT.
 * Requires: jQuery v1.9 or later
 */
!function(t,a){if("function"==typeof define&&define.amd&&define.amd.jQuery)define(["jquery"],function(t){return a(t)});else{if("object"!=typeof exports)return a(t.jQuery||t.$);module.exports=a(require("jquery"))}}(this,function(t){!function(){t.fn.ssdCascadingDropDown=function(a){"use strict";function e(t){return void 0===t||""===t||!1===t||t.length<1}function n(t,a){return t in a}function r(t){t.preventDefault(),t.stopPropagation()}function i(a){return t("[data-"+k.attrDataGroup+'="'+a+'"]')}function l(a,e){return t("[data-"+k.attrDataGroup+'="'+a+'"][data-'+k.attrDataId+'="'+e+'"]')}function o(a,e){return t("[data-"+k.attrDataGroup+'="'+a+'"][data-'+k.attrDataTarget+'="'+e+'"]')}function u(a){return t("[data-"+k.attrDataReplacementContainer+'="'+a+'"]')}function c(t){var a={group:t.data(k.attrDataGroup),id:t.data(k.attrDataId),target:t.data(k.attrDataTarget),url:t.data(k.attrDataUrl),value:t.val(),isValueEmpty:function(){return e(this.value)},replacementContainer:t.data(k.attrDataReplacement),final:t.data("final"),isFinal:function(){return void 0!==this.final}};return a.targetObject=l(a.group,a.target),a.targetDefaultLabel=a.targetObject.data(k.attrDataDefaultLabel),a.parent=o(a.group,a.id),a.parentUrl=a.parent.data(k.attrDataUrl),a}function f(){var t='<option value="';return t+=e(arguments[1])?"":arguments[1],t+='">',t+=e(arguments[0])?"Select one":arguments[0],t+="</option>"}function d(t){return f(t)}function p(t,a){return E.formatOptions(t,a[k.indexMenu])}function s(t,a){var n=u(t);0!==n.length&&(e(a)&&(a=n.data(k.attrDataReplacementDefault)),n.html(a))}function D(t,a,n){a.html(d(n)).prop("disabled",!0);var r=a.data(k.attrDataTarget);if(!e(r)){var i=l(t,r),o=i.data(k.attrDataDefaultLabel);i.length>0&&D(t,i,o)}}function m(a){var n=i(a.data(k.attrDataGroup)).not(":disabled"),r=[];return t.each(n,function(){e(t(this).val())||r.push({name:t(this).prop("name"),value:t(this).val()})}),r}function h(a){return t.param(a)}function g(t){if(!t)throw new Error("Invalid data received!");if(!t.success){if(!n(k.indexError,t))throw new Error("There was a problem with the request!");return k.errorCallback(t[k.indexError],t),!1}return!0}function b(t,a){return a.isFinal()?k.finalEmptyCallback(t,a,E):k.nonFinalEmptyCallback(t,a,E)}function v(a,n){b(a,n),e(n.parent)||e(n.parentUrl)?s(n.replacementContainer,""):t.getJSON(n.parentUrl+"?"+h(n.selection),function(t){g(t)&&(C(a,n,t),s(n.replacementContainer,t[k.indexReplacement]))})}function C(t,a,e){return a.isFinal()?k.finalCallback(t,a,e,E):k.nonFinalCallback(t,a,e,E)}function x(a,e){k.startCall(a,e),t.ajax({dataType:"json",url:e.url+"?"+h(e.selection),success:function(r){k.endCall(a,e),g(r)&&(C(a,e,r),n(k.indexMenu,r)&&t.when(p(e.targetDefaultLabel,r)).then(function(t){e.targetObject.html(t).prop("disabled",!1)}),n(k.indexReplacement,r)&&s(e.replacementContainer,r[k.indexReplacement]))},error:function(t,n,r){throw k.endCall(a,e),new Error(r)}})}function y(a){a.on("change",function(a){r(a);var n=t(this);if(!n.is(":disabled")){var i=c(n);e(i.url)||(e(i.target)||D(i.group,i.targetObject,i.targetDefaultLabel),i.selection=m(n),e(i.value)?v(n,i):x(n,i))}})}function R(t,a){return!e(a.attr(t))}function w(a){var e=t.Deferred(),n=[k.attrDataGroup,k.attrDataId,k.attrDataUrl,k.attrDataTarget,k.attrDataDefaultLabel,k.attrDataReplacement];return k.verify?t.each(n,function(t,r){R(r="data-"+r,a)||console.log(a.prop("name")+" is missing attribute "+r),t+1===n.length&&e.resolve()}):e.resolve(),e.promise()}function j(t){t.html(d(t.data(k.attrDataDefaultLabel))).prop("disabled",!0)}var E=this,k=t.extend({attrDataGroup:"group",attrDataId:"id",attrDataUrl:"url",attrDataTarget:"target",attrDataDefaultLabel:"default-label",attrDataReplacement:"replacement",attrDataReplacementContainer:"replacement-container",attrDataReplacementDefault:"default-content",classReplacementContainer:"cascadingContainer",indexSuccess:"success",indexError:"error",indexMenu:"menu",indexReplacement:"replacement",verify:!0,startCall:function(t,a){},endCall:function(t,a){},nonFinalCallback:function(t,a,e,n){},nonFinalEmptyCallback:function(t,a,e){},finalCallback:function(t,a,e,n){},finalEmptyCallback:function(t,a,e){},errorCallback:function(t,a){console.warn(t)}},a);return this.formatOptions=function(a,e){var n=t.Deferred(),r=d(a);return t.each(e,function(t,a){r+=f(a.name,a.value),t+1===e.length&&n.resolve(r)}),n.promise()},function(){var a=t("."+k.classReplacementContainer);t.each(a,function(){t(this).html(t(this).data(k.attrDataReplacementDefault))})}(),this.each(function(){var a=t(this);j(a.not(":enabled")),t.when(w(a)).then(function(){y(a)})})}}()});